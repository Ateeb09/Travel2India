{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Travel2India{% endblock %} - Explore Incredible India</title>
    <link rel="icon" href="{% static 'images/favicon.svg' %}" type="image/svg+xml">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=Playfair+Display:wght@500;600;700&display=swap" rel="stylesheet">
    {% block extra_head %}{% endblock %}
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1RF5ETFSBN"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-1RF5ETFSBN');
    </script>
</head>
<body>
    <!-- Modern Navbar -->
    <nav class="navbar-modern">
        <div class="nav-modern-container">
            <a href="{% url 'home' %}" class="brand-modern">
                <div class="flag-circle-sm">
                    {% if request.path == '/' %}
                    <video autoplay loop muted playsinline>
                        <source src="{% static 'videos/intro(2).mp4' %}" type="video/mp4">
                    </video>
                    {% else %}
                    <span class="flag-emoji">üáÆüá≥</span>
                    {% endif %}
                </div>
                <span class="brand-text">Travel2India</span>
            </a>
            <button class="nav-toggle" id="navToggle" aria-label="Menu">
                <i class="fas fa-bars"></i>
            </button>
            <ul class="nav-modern-links">
                <li><a href="{% url 'home' %}"><i class="fas fa-home"></i> Home</a></li>
                <li><a href="{% url 'destinations' %}"><i class="fas fa-map-marked-alt"></i> Destinations</a></li>
                <li><a href="{% url 'flight_booking' %}"><i class="fas fa-plane"></i> Book Flights</a></li>
                <li><a href="{% url 'inquiry' %}"><i class="fas fa-calendar-check"></i> Inquiry</a></li>
                <li><a href="{% url 'contact' %}"><i class="fas fa-envelope"></i> Contact</a></li>
                <li><a href="{% url 'payment' %}"><i class="fas fa-credit-card"></i> Payment</a></li>
                <li><a href="{% url 'about' %}"><i class="fas fa-info-circle"></i> About</a></li>
                <li><a href="{% url 'login' %}"><i class="fas fa-user"></i> Login</a></li>
            </ul>
        </div>
    </nav>

    <main class="main-content">
        {% block content %}
        {% endblock %}
    </main>

    <!-- Footer -->
    <footer class="footer-modern">
        <div class="footer-modern-inner">
            <div class="footer-brand">
                <h3>Travel2India <span class="flag-emoji">üáÆüá≥</span></h3>
                <p>Your gateway to exploring Incredible India</p>
                <div class="footer-social">
                    <span class="footer-social-label">Follow us</span>
                    <a href="https://facebook.com/travel2india" target="_blank" rel="noopener" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                    <a href="https://instagram.com/travel2india" target="_blank" rel="noopener" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                    <a href="https://twitter.com/travel2india" target="_blank" rel="noopener" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                    <a href="https://youtube.com/@travel2india" target="_blank" rel="noopener" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
                    <a href="https://linkedin.com/company/travel2india" target="_blank" rel="noopener" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                </div>
            </div>
            <div class="footer-links-modern">
                <a href="{% url 'home' %}">Home</a>
                <a href="{% url 'destinations' %}">Destinations</a>
                <a href="{% url 'contact' %}">Contact</a>
                <a href="{% url 'flight_booking' %}">Book Flights</a>
                <a href="{% url 'inquiry' %}">Trip Inquiry</a>
                <a href="{% url 'payment' %}">Payment</a>
            </div>
            <div class="footer-newsletter">
                <p>Get travel updates & offers</p>
                <form method="post" action="{% url 'subscribe' %}">
                    {% csrf_token %}
                    <input type="email" name="email" placeholder="Your email" required>
                    <button type="submit"><i class="fas fa-paper-plane"></i></button>
                </form>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; {{ year|default:2025 }} Travel2India. All rights reserved.</p>
        </div>
    </footer>

    <!-- Chatbot Widget -->
    <button type="button" class="chatbot-toggle" id="chatbotToggle" aria-label="Open chat">
        <i class="fas fa-comments"></i>
        <span>Chat with us</span>
    </button>
    <div id="chatbotBox" class="chatbot-box" aria-hidden="true">
        <div class="chatbot-box-header">
            <div class="chatbot-box-title"><i class="fas fa-robot"></i> Travel2India Assistant</div>
            <button type="button" class="chatbot-box-close" id="chatbotClose" aria-label="Close chat"><i class="fas fa-times"></i></button>
        </div>
        <div class="chatbot-box-body" id="chatbotBody">
            <div class="chat-msg bot-msg">
                <p>Hi! üëã I'm here to help you plan your India trip. Ask about <strong>destinations</strong>, <strong>flights</strong>, <strong>inquiry</strong>, or <strong>payment</strong>‚Äîor tap a quick option below.</p>
            </div>
            <div class="chat-quick-replies" id="chatQuickReplies">
                <button type="button" class="chat-chip" data-msg="Destinations">üó∫Ô∏è Destinations</button>
                <button type="button" class="chat-chip" data-msg="Book flight">‚úàÔ∏è Book flight</button>
                <button type="button" class="chat-chip" data-msg="Inquiry">üìã Trip inquiry</button>
                <button type="button" class="chat-chip" data-msg="Contact">üì© Contact</button>
                <button type="button" class="chat-chip" data-msg="Payment">üí≥ Payment</button>
            </div>
        </div>
        <div class="chatbot-box-footer">
            <input type="text" id="chatbotInput" placeholder="Type your question..." maxlength="500" autocomplete="off">
            <button type="button" id="chatbotSend" aria-label="Send"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      document.getElementById('navToggle')?.addEventListener('click', function() {
        document.querySelector('.nav-modern-links')?.classList.toggle('mobile-open');
      });
      (function(){
        var box=document.getElementById('chatbotBox'),toggle=document.getElementById('chatbotToggle'),close=document.getElementById('chatbotClose'),body=document.getElementById('chatbotBody'),input=document.getElementById('chatbotInput'),send=document.getElementById('chatbotSend');
        var homeUrl='{{ request.scheme }}://{{ request.get_host }}{% url "home" %}';
        var destUrl=homeUrl.replace(/\/?$/,'/')+'#destinations';
        var replies={
          'hello':{text:'Hello! üëã Welcome to Travel2India. You can ask me about destinations, flights, trip inquiry, contact, or payment. How can I help?',chips:['Destinations','Book flight','Payment']},
          'hi':{text:'Hi there! Need help planning your India trip? Ask about destinations, booking, or payments.',chips:['Destinations','Trip inquiry']},
          'destination':{text:'We have 17 amazing destinations: Kerala, Delhi, Agra, Jaipur, Jaisalmer, Jodhpur, Udaipur, Varanasi, Ladakh, Goa, Ranthambore, Meghalaya, Amritsar, Rishikesh, Kolkata, Darjeeling & Mumbai. Explore them on our <a href="'+destUrl+'">Destinations</a> section or ask about a specific place!',chips:['Kerala','Goa','Ladakh']},
          'place':{text:'We cover Kerala backwaters, Rajasthan (Jaipur, Udaipur, Jodhpur, Jaisalmer), Agra (Taj Mahal), Varanasi, Ladakh, Goa, Ranthambore, Meghalaya, Amritsar, Rishikesh, Kolkata, Darjeeling & Mumbai. Which one interests you?',chips:[]},
          'book':{text:'You can book flights from our <a href="'+homeUrl.replace(/\/?$/,'/')+'flight-booking/">Book Flights</a> page. For custom trip plans, use the <a href="'+homeUrl.replace(/\/?$/,'/')+'inquiry/">Trip Inquiry</a> form. Need to pay? Use our secure <a href="'+homeUrl.replace(/\/?$/,'/')+'payment/">Payment</a> page.',chips:['Book flight','Payment']},
          'flight':{text:'Book your flights on our <a href="'+homeUrl.replace(/\/?$/,'/')+'flight-booking/">Flight Booking</a> page. Enter from/to cities, date and passengers. For trip deposits or package payments, use the <a href="'+homeUrl.replace(/\/?$/,'/')+'payment/">Payment</a> page.',chips:[]},
          'ticket':{text:'Book flights on our <a href="'+homeUrl.replace(/\/?$/,'/')+'flight-booking/">Flight Booking</a> page. For payments use <a href="'+homeUrl.replace(/\/?$/,'/')+'payment/">Payment</a>.',chips:[]},
          'inquiry':{text:'Submit a <a href="'+homeUrl.replace(/\/?$/,'/')+'inquiry/">Trip Inquiry</a> with your name, email, destination, travel dates and message. We\'ll get back with a custom itinerary and quote.',chips:['Destinations']},
          'contact':{text:'Reach us via the <a href="'+homeUrl.replace(/\/?$/,'/')+'contact/">Contact</a> page. Send your name, email and message‚Äîwe\'ll reply soon!',chips:[]},
          'payment':{text:'We accept secure online payments (cards, UPI, netbanking) on our <a href="'+homeUrl.replace(/\/?$/,'/')+'payment/">Payment</a> page. You can pay a trip deposit or package amount. All payments are secured.',chips:['Payment']},
          'pay':{text:'Use our secure <a href="'+homeUrl.replace(/\/?$/,'/')+'payment/">Payment</a> page for trip deposits and package payments (cards, UPI, netbanking).',chips:[]},
          'price':{text:'Prices depend on your chosen destination, duration and package. Send a <a href="'+homeUrl.replace(/\/?$/,'/')+'inquiry/">Trip Inquiry</a> with your dates and we\'ll send a detailed quote.',chips:['Inquiry']},
          'cost':{text:'Send a <a href="'+homeUrl.replace(/\/?$/,'/')+'inquiry/">Trip Inquiry</a> with your dates for a detailed quote.',chips:[]},
          'thanks':{text:'You\'re welcome! Have a great trip to India. üáÆüá≥ Need anything else?',chips:[]},
          'thank':{text:'You\'re welcome! Happy to help.',chips:[]},
          'bye':{text:'Goodbye! Safe travels. Come back anytime.',chips:[]}
        };
        function getReply(msg){
          var m=msg.toLowerCase().trim();
          if(!m) return null;
          for(var k in replies){ if(m.indexOf(k)!==-1) return replies[k]; }
          if(m.length<3) return {text:'Could you tell me a bit more? Try "destinations", "book flight", "inquiry" or "payment".',chips:['Destinations','Contact']};
          return {text:'I can help with destinations, flight booking, trip inquiry, contact and payment. Try one of the quick options or ask: "What destinations do you have?" or "How do I pay?"',chips:['Destinations','Book flight','Payment']};
        }
        function addBotReply(text,chips){
          var wrap=document.createElement('div'); wrap.className='chat-msg bot-msg';
          var p=document.createElement('p'); p.innerHTML=text; wrap.appendChild(p);
          body.appendChild(wrap);
          if(chips&&chips.length){ var q=document.createElement('div'); q.className='chat-quick-replies';
            chips.forEach(function(c){ var b=document.createElement('button'); b.type='button'; b.className='chat-chip'; b.textContent=c; b.dataset.msg=c; b.addEventListener('click',function(){ addUserMsg(c); replyToMsg(c); }); q.appendChild(b); });
            wrap.appendChild(q);
          }
          body.scrollTop=body.scrollHeight;
        }
        function addUserMsg(text){ var wrap=document.createElement('div'); wrap.className='chat-msg user-msg'; var p=document.createElement('p'); p.textContent=text; wrap.appendChild(p); body.appendChild(wrap); body.scrollTop=body.scrollHeight; }
        function replyToMsg(msg){ var r=getReply(msg); if(r) addBotReply(r.text,r.chips); }
        function sendChat(){ var t=(input.value||'').trim(); if(!t) return; input.value=''; addUserMsg(t); replyToMsg(t); }
        toggle&&toggle.addEventListener('click',function(){ box.classList.add('chatbot-box-open'); box.setAttribute('aria-hidden','false'); input.focus(); });
        close&&close.addEventListener('click',function(){ box.classList.remove('chatbot-box-open'); box.setAttribute('aria-hidden','true'); });
        send&&send.addEventListener('click',sendChat);
        input&&input.addEventListener('keypress',function(e){ if(e.key==='Enter') sendChat(); });
        body&&body.querySelectorAll('.chat-chip').forEach(function(btn){ btn.addEventListener('click',function(){ addUserMsg(this.dataset.msg); replyToMsg(this.dataset.msg); this.closest('.chat-quick-replies')?.remove(); }); });
      })();
    </script>
    {% block extra_scripts %}{% endblock %}
</body>
</html>
